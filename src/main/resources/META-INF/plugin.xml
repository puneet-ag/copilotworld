<idea-plugin>
    <id>com.dpworld.chatgpt</id>
    <name>CodeGPT</name>
    <vendor email="carlrobertoh@gmail.com" url="https://carlrobert.ee">Carl-Robert Linnupuu</vendor>
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends optional="true" config-file="plugin-java.xml">com.intellij.modules.java</depends>

    <projectListeners>
        <listener topic="com.intellij.codeInsight.lookup.LookupManagerListener"
                  class="panel.converted.MethodNameLookupListener"/>
        <listener topic="com.intellij.openapi.wm.ex.ToolWindowManagerListener"
                  class="panel.converted.ChatToolWindowListener"/>
    </projectListeners>

    <extensions defaultExtensionNs="com.intellij">
        <postStartupActivity implementation="panel.converted.CodeGPTProjectActivity"/>
        <postStartupActivity implementation="panel.converted.CodeGPTUpdateActivity"/>
        <applicationConfigurable id="settings.codegpt" parentId="tools" displayName="CodeGPT"
                                 instance="panel.converted.GeneralSettingsConfigurable"/>
        <applicationConfigurable id="settings.codegpt.services" parentId="settings.codegpt" displayName="Providers"
                                 instance="panel.ServiceConfigurable"/>
        <applicationConfigurable id="settings.codegpt.services.ollama" parentId="settings.codegpt.services" displayName="Ollama (Local)"
                                 instance="panel.converted.OllamaSettingsConfigurable"/>
        <applicationConfigurable id="settings.codegpt.configuration" parentId="settings.codegpt" displayName="Configuration"
                                 instance="panel.converted.ConfigurationConfigurable"/>
        <applicationConfigurable id="settings.codegpt.advanced" parentId="settings.codegpt" displayName="Advanced Settings"
                                 instance="advanced.AdvancedSettingsConfigurable"/>

        <applicationService serviceImplementation="panel.converted.GeneralSettings"/>
        <applicationService serviceImplementation="model.OllamaSettings"/>
        <applicationService serviceImplementation="panel.converted.ConfigurationSettings"/>
        <applicationService serviceImplementation="advanced.AdvancedSettings"/>
        <applicationService serviceImplementation="panel.converted.ConversationsState"/>
        <applicationService serviceImplementation="panel.converted.IncludedFilesSettings"/>

        <inline.completion.provider
                id="CodeGPTInlineCompletionProvider"
                implementation="panel.CodeGPTInlineCompletionProvider"/>
        <toolWindow id="CodeGPT" icon="panel.converted.Icons.DefaultSmall" anchor="right"
                    factoryClass="panel.converted.ProjectToolWindowFactory"/>
        <notificationGroup id="CodeGPT Notification Group" displayType="BALLOON" key="notification.group.name"/>
        <notificationGroup id="CodeGPT Notification Group Sticky" displayType="STICKY_BALLOON" key="notification.group.sticky.name"/>
        <statusBarWidgetFactory order="first" id="ee.carlrobert.codegpt.statusbar.widget"
                                implementation="panel.converted.CodeGPTStatusBarWidgetFactory"/>
    </extensions>

    <resource-bundle>messages.codegpt</resource-bundle>

    <actions>
        <group id="CodeGPTEditorPopup">
            <group id="action.editor.group.EditorActionGroup"
                   text="CodeGPT"
                   class="com.intellij.openapi.actionSystem.DefaultActionGroup"
                   popup="true"
                   icon="panel.converted.Icons.DefaultSmall">
            </group>
            <add-to-group group-id="EditorPopupMenu1" anchor="first"/>
            <separator/>
        </group>
        <action id="CodeGPT.TriggerEditorPopup"
                class="panel.converted.ShowEditorActionGroupAction"
                text="Show CodeGPT Actions">
            <keyboard-shortcut first-keystroke="ctrl shift alt m" keymap="$default"/>
        </action>
        <group id="CodeGPT.ProjectViewPopupMenuRootGroup">
            <group id="CodeGPT.ProjectViewPopupMenuGroup"
                   text="CodeGPT"
                   class="com.intellij.openapi.actionSystem.DefaultActionGroup"
                   popup="true"
                   icon="panel.converted.Icons.DefaultSmall">
                <action
                        id="CodeGPT.IncludeFilesInContextAction"
                        class="panel.converted.IncludeFilesInContextAction" />
            </group>
            <add-to-group
                    group-id="ProjectViewPopupMenu"
                    relative-to-action="ProjectViewPopupMenuRefactoringGroup"
                    anchor="before"/>
            <separator/>
        </group>

        <action
                id="codegpt.openSettings"
                text="Open Settings"
                class="panel.converted.OpenSettingsAction">
            <override-text place="MainMenu" text="Open Settings"/>
            <override-text place="popup" use-text-of-place="MainMenu"/>
        </action>
        <action
                id="statusbar.enableCompletions"
                class="actions.EnableCompletionsAction">
            <keyboard-shortcut first-keystroke="ctrl shift alt c" keymap="$default"/>

            <override-text place="MainMenu"/>
            <override-text place="popup" use-text-of-place="MainMenu"/>
        </action>
        <action
                id="statusbar.disableCompletions"
                class="actions.DisableCompletionsAction">
            <keyboard-shortcut first-keystroke="ctrl shift alt c" keymap="$default"/>

            <override-text place="MainMenu"/>
            <override-text place="popup" use-text-of-place="MainMenu"/>
        </action>
<!--        <action-->
<!--                id="statusbar.startServer"-->
<!--                class="panel.converted.StartServerAction">-->
<!--            <keyboard-shortcut first-keystroke="ctrl shift alt s" keymap="$default"/>-->

<!--            <override-text place="MainMenu"/>-->
<!--            <override-text place="popup" use-text-of-place="MainMenu"/>-->
<!--        </action>-->
<!--        <action-->
<!--                id="statusbar.stopServer"-->
<!--                class="panel.converted.StopServerAction">-->
<!--            <keyboard-shortcut first-keystroke="ctrl shift alt s" keymap="$default"/>-->

<!--            <override-text place="MainMenu"/>-->
<!--            <override-text place="popup" use-text-of-place="MainMenu"/>-->
<!--        </action>-->

        <group id="codegpt.statusBarPopup">
            <reference id="codegpt.openSettings" />
            <separator/>
<!--            <reference id="statusbar.stopServer" />-->
<!--            <reference id="statusbar.startServer" />-->
            <reference id="statusbar.disableCompletions" />
            <reference id="statusbar.enableCompletions" />
        </group>

<!--        <group id="CodeGPT.GenerateGitCommitMessageGroup">-->
<!--            <add-to-group group-id="Vcs.MessageActionGroup" anchor="first"/>-->
<!--            <action-->
<!--                    id="CodeGPT.GenerateGitCommitMessage"-->
<!--                    class="ee.carlrobert.codegpt.actions.GenerateGitCommitMessageAction" />-->
<!--        </group>-->
    </actions>
</idea-plugin>
